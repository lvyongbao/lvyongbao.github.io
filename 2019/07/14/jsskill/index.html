<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/aplayer/1.10.1/APlayer.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/aplayer/1.10.1/APlayer.min.js"></script>


<title>
  
    JS中的一些骚操作
  
</title>

<meta name="description" content="1、类型强制转换1.1 string强制转换为数字 之前我们有说过用+来转化字符串为数字，今天在分享一种，可以用 *1来转化为数字(实际上是调用 .valueOf方法) 然后使用 Number.isNaN来判断是否为 NaN，或者使用 a!==a 来判断是否为 NaN，因为 NaN!==NaN 12345&apos;32&apos; * 1            // 32&apos;ds&apos; * 1            //">
<meta property="og:type" content="article">
<meta property="og:title" content="JS中的一些骚操作">
<meta property="og:url" content="http://yoursite.com/2019/07/14/jsskill/index.html">
<meta property="og:site_name" content="一个爱听歌的搬砖工">
<meta property="og:description" content="1、类型强制转换1.1 string强制转换为数字 之前我们有说过用+来转化字符串为数字，今天在分享一种，可以用 *1来转化为数字(实际上是调用 .valueOf方法) 然后使用 Number.isNaN来判断是否为 NaN，或者使用 a!==a 来判断是否为 NaN，因为 NaN!==NaN 12345&apos;32&apos; * 1            // 32&apos;ds&apos; * 1            //">
<meta property="og:locale" content="zh-CN">
<meta property="og:updated_time" content="2021-05-20T05:37:35.648Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="JS中的一些骚操作">
<meta name="twitter:description" content="1、类型强制转换1.1 string强制转换为数字 之前我们有说过用+来转化字符串为数字，今天在分享一种，可以用 *1来转化为数字(实际上是调用 .valueOf方法) 然后使用 Number.isNaN来判断是否为 NaN，或者使用 a!==a 来判断是否为 NaN，因为 NaN!==NaN 12345&apos;32&apos; * 1            // 32&apos;ds&apos; * 1            //">


  <link rel="alternative" href="/atom.xml" title="一个爱听歌的搬砖工" type="application/atom+xml">



  <link rel="icon" href="/favicon.png">


<link rel="stylesheet" href="/perfect-scrollbar/css/perfect-scrollbar.min.css">
<link rel="stylesheet" href="/styles/main.css">






</head>
<body class="monochrome">
  <div class="mobile-header">
  <button class="sidebar-toggle" type="button">
    <span class="icon-bar"></span>
    <span class="icon-bar"></span>
    <span class="icon-bar"></span>
  </button>
  <a class="title" href="/">一个爱听歌的搬砖工</a>
</div>

  <div class="main-container">
    <div class="sidebar">
  <div class="header">
    <h1 class="title"><a href="/">一个爱听歌的搬砖工</a></h1>
    
    <div class="info">
      <div class="content">
        
        
          <div class="author">吕永宝</div>
        
      </div>
      
        <div class="avatar">
          
            <img src="/uploads/avatar.jpg">
          
        </div>
      
    </div>
  </div>
  <div class="body">
    
      
        <ul class="nav">
          
            
              <li class="category-list-container">
                <a href="javascript:;">分类</a>
                
              </li>
            
          
            
              <li class="tag-list-container">
                <a href="javascript:;">标签</a>
                
              </li>
            
          
            
              <li class="archive-list-container">
                <a href="javascript:;">归档</a>
                <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/">2022</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/">2020</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/">2019</a><span class="archive-list-count">46</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/">2018</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/">2017</a><span class="archive-list-count">4</span></li></ul>
              </li>
            
          
        </ul>
      
    
  </div>
  <div class="aplayer" data-id="3834011938" data-server="tencent" data-type="playlist" data-mode="circulation" data-autoplay="false"></div>
</div>

    <div class="main-content">
      
        <div style="max-width: 1000px">
      
          <article id="post-jsskill" class="article article-type-post">
  
    <h1 class="article-header">
      JS中的一些骚操作
    </h1>
  
  

  <div class="article-info">
    <span class="article-date">
  2019-07-14
</span>

    

    

  </div>
  <div class="article-entry">
    <h2 id="1、类型强制转换"><a href="#1、类型强制转换" class="headerlink" title="1、类型强制转换"></a>1、类型强制转换</h2><p><strong>1.1 string强制转换为数字</strong></p>
<p>之前我们有说过用+来转化字符串为数字，今天在分享一种，可以用 *1来转化为数字(实际上是调用 .valueOf方法)</p>
<p>然后使用 Number.isNaN来判断是否为 NaN，或者使用 a!==a 来判断是否为 NaN，因为 NaN!==NaN</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">'32'</span> * <span class="number">1</span>            <span class="comment">// 32</span></span><br><span class="line"><span class="string">'ds'</span> * <span class="number">1</span>            <span class="comment">// NaN</span></span><br><span class="line"><span class="literal">null</span> * <span class="number">1</span>            <span class="comment">// 0</span></span><br><span class="line"><span class="literal">undefined</span> * <span class="number">1</span>    <span class="comment">// NaN</span></span><br><span class="line"><span class="number">1</span>  * &#123; <span class="attr">valueOf</span>: <span class="function"><span class="params">()</span>=&gt;</span><span class="string">'3'</span> &#125;        <span class="comment">// 3</span></span><br></pre></td></tr></table></figure>

<a id="more"></a>

<p><strong>1.2 object强制转化为string</strong></p>
<p>可以使用 字符串+Object 的方式来转化对象为字符串(实际上是调用 .toString() 方法)</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">'the Math object:'</span> + <span class="built_in">Math</span>                <span class="comment">// "the Math object:[object Math]"</span></span><br><span class="line"><span class="string">'the JSON object:'</span> + <span class="built_in">JSON</span>              <span class="comment">// "the JSON object:[object JSON]"</span></span><br></pre></td></tr></table></figure>

<p>当然也可以覆盖对象的 toString和 valueOf方法来自定义对象的类型转换：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">2</span>  * &#123; <span class="attr">valueOf</span>: <span class="function"><span class="params">()</span>=&gt;</span><span class="string">'3'</span> &#125;                <span class="comment">// 6</span></span><br><span class="line"><span class="string">'J'</span> + &#123; <span class="attr">toString</span>: <span class="function"><span class="params">()</span>=&gt;</span><span class="string">'S'</span> &#125;                <span class="comment">// "JS"</span></span><br></pre></td></tr></table></figure>

<p>对象通过 valueOf方法强制转换为数字，通过 toString方法强制转换为字符串</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">''</span> + &#123;<span class="attr">toString</span>:<span class="function"><span class="params">()</span>=&gt;</span><span class="string">'S'</span>,<span class="attr">valueOf</span>:<span class="function"><span class="params">()</span>=&gt;</span><span class="string">'J'</span>&#125;                <span class="comment">// J</span></span><br></pre></td></tr></table></figure>

<p><strong>1.3 使用Boolean过滤数组中的所有假值</strong></p>
<p>我们知道JS中有一些假值：false， null， 0， “”， undefined， NaN，怎样把数组中的假值快速过滤呢，可以使用Boolean构造函数来进行一次转换</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> compact = <span class="function"><span class="params">arr</span> =&gt;</span> arr.filter(<span class="built_in">Boolean</span>)</span><br><span class="line">compact([<span class="number">0</span>, <span class="number">1</span>, <span class="literal">false</span>, <span class="number">2</span>, <span class="string">''</span>, <span class="number">3</span>, <span class="string">'a'</span>, <span class="string">'e'</span> * <span class="number">23</span>, <span class="literal">NaN</span>, <span class="string">'s'</span>, <span class="number">34</span>])             <span class="comment">// [ 1, 2, 3, 'a', 's', 34 ]</span></span><br></pre></td></tr></table></figure>

<p><strong>1.4 双位运算符 ~~</strong></p>
<p>可以使用双位操作符来替代正数的 Math.floor()，替代负数的 Math.ceil()。双否定位操作符的优势在于它执行相同的操作运行速度更快。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Math</span>.floor(<span class="number">4.9</span>) === <span class="number">4</span>      <span class="comment">//true</span></span><br><span class="line"><span class="comment">// 简写为：</span></span><br><span class="line">~~<span class="number">4.9</span> === <span class="number">4</span>      <span class="comment">//true</span></span><br></pre></td></tr></table></figure>

<p>不过要注意，对正数来说 ~~ 运算结果与 Math.floor() 运算结果相同，而对于负数来说与 Math.ceil()的运算结果相同：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">~~<span class="number">4.5</span>                <span class="comment">// 4</span></span><br><span class="line"><span class="built_in">Math</span>.floor(<span class="number">4.5</span>)      <span class="comment">// 4</span></span><br><span class="line"><span class="built_in">Math</span>.ceil(<span class="number">4.5</span>)       <span class="comment">// 5</span></span><br><span class="line"></span><br><span class="line">~~<span class="number">-4.5</span>                <span class="comment">// -4</span></span><br><span class="line"><span class="built_in">Math</span>.floor(<span class="number">-4.5</span>)     <span class="comment">// -5</span></span><br><span class="line"><span class="built_in">Math</span>.ceil(<span class="number">-4.5</span>)      <span class="comment">// -4</span></span><br></pre></td></tr></table></figure>

<p><strong>1.5 短路运算符</strong></p>
<p>我们知道逻辑与 &amp;&amp;与逻辑或 ||是短路运算符，短路运算符就是从左到右的运算中前者满足要求，就不再执行后者了；</p>
<p>可以理解为：</p>
<blockquote>
<ul>
<li>&amp;&amp;为取假运算，从左到右依次判断，如果遇到一个假值，就返回假值，以后不再执行，否则返回最后一个真值</li>
<li>||为取真运算，从左到右依次判断，如果遇到一个真值，就返回真值，以后不再执行，否则返回最后一个假值</li>
</ul>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> param1 = expr1 &amp;&amp; expr2</span><br><span class="line"><span class="keyword">let</span> param2 = expr1 || expr2</span><br></pre></td></tr></table></figure>

<p>| 运算符 | 示例 | 说明 |</p>
<p>| — | — | — |</p>
<p>| &amp;&amp; | expr1&amp;&amp;expr2 | 如果expr1 能转换成false则返回expr1,否则返回expr2. 因此, 在Boolean环境中使用时, 两个操作结果都为true时返回true,否则返回false. |</p>
<p>| || | expr1||expr2 | 如果expr1能转换成true则返回expr1,否则返回expr2. 因此,在boolean环境(在if的条件判断中)中使用时, 二者操作结果中只要有一个为true,返回true;二者操作结果都为false时返回false. |</p>
<p>| ! | !expr | 如果单个表达式能转换为true的话返回false,否则返回true. |</p>
<p>因此可以用来做很多有意思的事，比如给变量赋初值：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> variable1</span><br><span class="line"><span class="keyword">let</span> variable2 = variable1  || <span class="string">'foo'</span></span><br></pre></td></tr></table></figure>

<p>如果variable1是真值就直接返回了，后面短路就不会被返回了，如果为假值，则会返回后面的 foo。</p>
<p>也可以用来进行简单的判断，取代冗长的 if语句：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> variable = param &amp;&amp; param.prop</span><br></pre></td></tr></table></figure>

<p>如果 param如果为真值则返回 param.prop属性，否则返回 param这个假值，这样在某些地方防止 param为 undefined的时候还取其属性造成报错。</p>
<p><strong>1.6 取整 |0</strong></p>
<p>对一个数字 |0可以取整，负数也同样适用， num|0</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.3</span> | <span class="number">0</span>         <span class="comment">// 1</span></span><br><span class="line"><span class="number">-1.9</span> | <span class="number">0</span>        <span class="comment">// -1</span></span><br></pre></td></tr></table></figure>

<p>1.7 判断奇偶数 &amp;1</p>
<p>对一个数字 &amp;1可以判断奇偶数，负数也同样适用， num&amp;1</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> num=<span class="number">3</span>;</span><br><span class="line">!!(num &amp; <span class="number">1</span>)                    <span class="comment">// true</span></span><br><span class="line">!!(num % <span class="number">2</span>)                    <span class="comment">// true</span></span><br></pre></td></tr></table></figure>

<h2 id="2、函数"><a href="#2、函数" class="headerlink" title="2、函数"></a>2、函数</h2><p><strong>2.1 函数默认值</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">func = <span class="function">(<span class="params">l, m = <span class="number">3</span>, n = <span class="number">4</span> </span>) =&gt;</span> (l * m * n);</span><br><span class="line">func(<span class="number">2</span>)             <span class="comment">//output: 24</span></span><br></pre></td></tr></table></figure>

<p>注意，传入参数为 undefined或者不传入的时候会使用默认参数，但是传入 null还是会覆盖默认参数。</p>
<p><strong>2.2 强制参数</strong></p>
<p>默认情况下，如果不向函数参数传值，那么JS 会将函数参数设置为 undefined。其它一些语言则会发出警告或错误。要执行参数分配，可以使用 if语句抛出未定义的错误，或者可以利用 强制参数。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">mandatory = <span class="function"><span class="params">( )</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">'Missing parameter!'</span>);</span><br><span class="line">&#125;</span><br><span class="line">foo = <span class="function">(<span class="params">bar = mandatory( </span>)) =&gt;</span> &#123;     <span class="comment">// 这里如果不传入参数，就会执行manadatory函数报出错误</span></span><br><span class="line">  <span class="keyword">return</span> bar;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>2.3 隐式返回值</strong></p>
<p>返回值是我们通常用来返回函数最终结果的关键字。只有一个语句的箭头函数，可以隐式返回结果（函数必须省略大括号 {}，以便省略返回关键字）。</p>
<p>要返回多行语句（例如对象文本），需要使用 ()而不是 {}来包裹函数体。这样可以确保代码以单个语句的形式进行求值。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">calcCircumference</span>(<span class="params">diameter</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">Math</span>.PI * diameter</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 简写为：</span></span><br><span class="line">calcCircumference = <span class="function"><span class="params">diameter</span> =&gt;</span> (</span><br><span class="line">  <span class="built_in">Math</span>.PI * diameter;</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<p><strong>2.4 惰性载入函数</strong></p>
<p>在某个场景下我们的函数中有判断语句，这个判断依据在整个项目运行期间一般不会变化，所以判断分支在整个项目运行期间只会运行某个特定分支，那么就可以考虑惰性载入函数</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(a !== b)&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'aaa'</span>)</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'bbb'</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 优化后</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(a != b)&#123;</span><br><span class="line">        foo = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">'aaa'</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        foo = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">'bbb'</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> foo();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>那么第一次运行之后就会覆写这个方法，下一次再运行的时候就不会执行判断了。当然现在只有一个判断，如果判断很多，分支比较复杂，那么节约的资源还是可观的。</p>
<p><strong>2.5 一次性函数</strong></p>
<p>跟上面的惰性载入函数同理，可以在函数体里覆写当前函数，那么可以创建一个一次性的函数，重新赋值之前的代码相当于只运行了一次，适用于运行一些只需要执行一次的初始化代码</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> sca = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'msg'</span>)</span><br><span class="line">    sca = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'foo'</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">sca()        <span class="comment">// msg</span></span><br><span class="line">sca()        <span class="comment">// foo</span></span><br><span class="line">sca()        <span class="comment">// foo</span></span><br></pre></td></tr></table></figure>

<h2 id="3、字符串"><a href="#3、字符串" class="headerlink" title="3、字符串"></a>3、字符串</h2><p><strong>3.1 字符串比较时间先后</strong></p>
<p>比较时间先后顺序可以使用字符串：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = <span class="string">"2014-08-08"</span>;</span><br><span class="line"><span class="keyword">var</span> b = <span class="string">"2014-09-09"</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(a&gt;b, a&lt;b); <span class="comment">// false true</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">"21:00"</span>&lt;<span class="string">"09:10"</span>);  <span class="comment">// false</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">"21:00"</span>&lt;<span class="string">"9:10"</span>);   <span class="comment">// true   时间形式注意补</span></span><br></pre></td></tr></table></figure>

<p>因为字符串比较大小是按照字符串从左到右每个字符的 charCode来的，但所以特别要注意时间形式注意补0</p>
<h2 id="4、数字"><a href="#4、数字" class="headerlink" title="4、数字"></a>4、数字</h2><p><strong>4.1 不同进制表示法</strong></p>
<p>ES6中新增了不同进制的书写格式，在后台传参的时候要注意这一点。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">29</span>            <span class="comment">// 10进制</span></span><br><span class="line"><span class="number">035</span>            <span class="comment">// 8进制29      原来的方式</span></span><br><span class="line"><span class="number">0o35</span>            <span class="comment">// 8进制29      ES6的方式</span></span><br><span class="line"><span class="number">0x1d</span>            <span class="comment">// 16进制29</span></span><br><span class="line"><span class="number">0b11101</span>            <span class="comment">// 2进制29</span></span><br></pre></td></tr></table></figure>

<p><strong>4.2 精确到指定位数的小数</strong></p>
<p>将数字四舍五入到指定的小数位数。使用 Math.round() 和模板字面量将数字四舍五入为指定的小数位数。 省略第二个参数 decimals ，数字将被四舍五入到一个整数。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> round = <span class="function">(<span class="params">n, decimals = <span class="number">0</span></span>) =&gt;</span> <span class="built_in">Number</span>(<span class="string">`<span class="subst">$&#123;<span class="built_in">Math</span>.round(<span class="string">`<span class="subst">$&#123;n&#125;</span>e<span class="subst">$&#123;decimals&#125;</span>`</span>)&#125;</span>e-<span class="subst">$&#123;decimals&#125;</span>`</span>)</span><br><span class="line">round(<span class="number">1.345</span>, <span class="number">2</span>)                 <span class="comment">// 1.35</span></span><br><span class="line">round(<span class="number">1.345</span>, <span class="number">1</span>)                 <span class="comment">// 1.3</span></span><br></pre></td></tr></table></figure>

<p><strong>4.3 数字补0操作</strong></p>
<p>有时候比如显示时间的时候有时候会需要把一位数字显示成两位，这时候就需要补0操作，可以使用 slice和string的 padStart方法</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> addZero1 = <span class="function">(<span class="params">num, len = <span class="number">2</span></span>) =&gt;</span> (<span class="string">`0<span class="subst">$&#123;num&#125;</span>`</span>).slice(-len)</span><br><span class="line"><span class="keyword">const</span> addZero2 = <span class="function">(<span class="params">num, len = <span class="number">2</span></span>) =&gt;</span> (<span class="string">`<span class="subst">$&#123;num&#125;</span>`</span>).padStart( len   , <span class="string">'0'</span>)</span><br><span class="line">addZero1(<span class="number">3</span>) <span class="comment">// 03</span></span><br><span class="line"></span><br><span class="line">addZero2(<span class="number">32</span>,<span class="number">4</span>)  <span class="comment">// 0032</span></span><br></pre></td></tr></table></figure>

<h2 id="5、数组"><a href="#5、数组" class="headerlink" title="5、数组"></a>5、数组</h2><p><strong>5.1 reduce方法同时实现map和filter</strong></p>
<p>假设现在有一个数列，你希望更新它的每一项（map的功能）然后筛选出一部分（filter的功能）。如果是先使用map然后filter的话，你需要遍历这个数组两次。</p>
<p>在下面的代码中，我们将数列中的值翻倍，然后挑选出那些大于50的数。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> numbers = [<span class="number">10</span>, <span class="number">20</span>, <span class="number">30</span>, <span class="number">40</span>];</span><br><span class="line"><span class="keyword">const</span> doubledOver50 = numbers.reduce(<span class="function">(<span class="params">finalList, num</span>) =&gt;</span> &#123;</span><br><span class="line">  num = num * <span class="number">2</span>;</span><br><span class="line">  <span class="keyword">if</span> (num &gt; <span class="number">50</span>) &#123;</span><br><span class="line">    finalList.push(num);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> finalList;</span><br><span class="line">&#125;, []);</span><br><span class="line">doubledOver50;            <span class="comment">// [60, 80]</span></span><br></pre></td></tr></table></figure>

<p><strong>5.2 统计数组中相同项的个数</strong></p>
<p>很多时候，你希望统计数组中重复出现项的个数然后用一个对象表示。那么你可以使用reduce方法处理这个数组。</p>
<p>下面的代码将统计每一种车的数目然后把总数用一个对象表示。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> cars = [<span class="string">'BMW'</span>,<span class="string">'Benz'</span>, <span class="string">'Benz'</span>, <span class="string">'Tesla'</span>, <span class="string">'BMW'</span>, <span class="string">'Toyota'</span>];</span><br><span class="line"><span class="keyword">var</span> carsObj = cars.reduce(<span class="function"><span class="keyword">function</span> (<span class="params">obj, name</span>) </span>&#123;</span><br><span class="line">  obj[name] = obj[name] ? ++obj[name] : <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">return</span> obj;</span><br><span class="line">&#125;, &#123;&#125;);</span><br><span class="line">carsObj; <span class="comment">// =&gt; &#123; BMW: 2, Benz: 2, Tesla: 1, Toyota: 1 &#125;</span></span><br></pre></td></tr></table></figure>

<p><strong>5.3 使用解构来交换参数数值</strong></p>
<p>有时候你会将函数返回的多个值放在一个数组里。我们可以使用数组解构来获取其中每一个值。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> param1 = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">let</span> param2 = <span class="number">2</span>;</span><br><span class="line">[param1, param2] = [param2, param1];</span><br><span class="line"><span class="built_in">console</span>.log(param1) <span class="comment">// 2</span></span><br><span class="line"><span class="built_in">console</span>.log(param2) <span class="comment">// 1</span></span><br></pre></td></tr></table></figure>

<p>当然我们关于交换数值有不少其他办法：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> temp = a; a = b; b = temp</span><br><span class="line">b = [a, a = b][<span class="number">0</span>]</span><br><span class="line">a = a + b; b = a - b; a = a - b</span><br></pre></td></tr></table></figure>

<p><strong>5.4 接收函数返回的多个结果</strong></p>
<p>在下面的代码中，我们从/post中获取一个帖子，然后在/comments中获取相关评论。由于我们使用的是async/await，函数把返回值放在一个数组中。而我们使用数组解构后就可以把返回值直接赋给相应的变量。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">getFullPost</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">await</span> <span class="built_in">Promise</span>.all([</span><br><span class="line">     fetch(<span class="string">'/post'</span>),</span><br><span class="line">     fetch(<span class="string">'/comments'</span>)</span><br><span class="line">  ]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> [post, comments] = getFullPost();</span><br></pre></td></tr></table></figure>

<p><strong>5.5 将数组平铺到指定深度</strong></p>
<p>使用递归，为每个深度级别 depth 递减 1 。 使用 Array.reduce() 和 Array.concat() 来合并元素或数组。 基本情况下， depth 等于 1 停止递归。 省略第二个参数， depth 只能平铺到 1 (单层平铺) 的深度。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> flatten = <span class="function">(<span class="params">arr, depth = <span class="number">1</span></span>) =&gt;</span></span><br><span class="line">  depth != <span class="number">1</span></span><br><span class="line">    ? arr.reduce(<span class="function">(<span class="params">a, v</span>) =&gt;</span> a.concat(<span class="built_in">Array</span>.isArray(v) ? flatten(v, depth - <span class="number">1</span>) : v), [])</span><br><span class="line">    : arr.reduce(<span class="function">(<span class="params">a, v</span>) =&gt;</span> a.concat(v), []);</span><br><span class="line">flatten([<span class="number">1</span>, [<span class="number">2</span>], <span class="number">3</span>, <span class="number">4</span>]);                             <span class="comment">// [1, 2, 3, 4]</span></span><br><span class="line">flatten([<span class="number">1</span>, [<span class="number">2</span>, [<span class="number">3</span>, [<span class="number">4</span>, <span class="number">5</span>], <span class="number">6</span>], <span class="number">7</span>], <span class="number">8</span>], <span class="number">2</span>);           <span class="comment">// [1, 2, 3, [4, 5], 6, 7, 8]</span></span><br></pre></td></tr></table></figure>

<p><strong>5.6 数组的对象解构</strong></p>
<p>数组也可以对象解构，可以方便的获取数组的第n个值</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> csvFileLine = <span class="string">'1997,John Doe,US,john@doe.com,New York'</span>;</span><br><span class="line"><span class="keyword">const</span> &#123; <span class="number">2</span>: country, <span class="number">4</span>: state &#125; = csvFileLine.split(<span class="string">','</span>);</span><br><span class="line"></span><br><span class="line">country            <span class="comment">// US</span></span><br><span class="line">state            <span class="comment">// New Yourk</span></span><br></pre></td></tr></table></figure>

<h2 id="6、对象"><a href="#6、对象" class="headerlink" title="6、对象"></a>6、对象</h2><p><strong>6.1 使用解构删除不必要属性</strong></p>
<p>有时候你不希望保留某些对象属性，也许是因为它们包含敏感信息或仅仅是太大了（just too big）。你可能会枚举整个对象然后删除它们，但实际上只需要简单的将这些无用属性赋值给变量，然后把想要保留的有用部分作为剩余参数就可以了。</p>
<p>下面的代码里，我们希望删除_internal和tooBig参数。我们可以把它们赋值给internal和tooBig变量，然后在cleanObject中存储剩下的属性以备后用。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> &#123;_internal, tooBig, ...cleanObject&#125; = &#123;<span class="attr">el1</span>: <span class="string">'1'</span>, <span class="attr">_internal</span>:<span class="string">"secret"</span>, <span class="attr">tooBig</span>:&#123;&#125;, <span class="attr">el2</span>: <span class="string">'2'</span>, <span class="attr">el3</span>: <span class="string">'3'</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(cleanObject);                         <span class="comment">// &#123;el1: '1', el2: '2', el3: '3'&#125;</span></span><br></pre></td></tr></table></figure>

<p><strong>6.2 在函数参数中解构嵌套对象</strong></p>
<p>在下面的代码中，engine是对象car中嵌套的一个对象。如果我们对engine的vin属性感兴趣，使用解构赋值可以很轻松地得到它。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> car = &#123;</span><br><span class="line">  model: <span class="string">'bmw 2018'</span>,</span><br><span class="line">  engine: &#123;</span><br><span class="line">    v6: <span class="literal">true</span>,</span><br><span class="line">    turbo: <span class="literal">true</span>,</span><br><span class="line">    vin: <span class="number">12345</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> modelAndVIN = <span class="function">(<span class="params">&#123;model, engine: &#123;vin&#125;&#125;</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">`model: <span class="subst">$&#123;model&#125;</span> vin: <span class="subst">$&#123;vin&#125;</span>`</span>);</span><br><span class="line">&#125;</span><br><span class="line">modelAndVIN(car); <span class="comment">// =&gt; model: bmw 2018  vin: 12345</span></span><br></pre></td></tr></table></figure>

<h2 id="7、代码复用"><a href="#7、代码复用" class="headerlink" title="7、代码复用"></a>7、代码复用</h2><p><strong>7.1 Object [key]</strong></p>
<p>虽然将 foo.bar 写成 foo[‘bar’] 是一种常见的做法，但是这种做法构成了编写可重用代码的基础。许多框架使用了这种方法，比如element的表单验证。</p>
<p>请考虑下面这个验证函数的简化示例：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">validate</span>(<span class="params">values</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(!values.first)</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">  <span class="keyword">if</span>(!values.last)</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(validate(&#123;<span class="attr">first</span>:<span class="string">'Bruce'</span>,<span class="attr">last</span>:<span class="string">'Wayne'</span>&#125;)); <span class="comment">// true</span></span><br></pre></td></tr></table></figure>

<p>上面的函数完美的完成验证工作。但是当有很多表单，则需要应用验证，此时会有不同的字段和规则。如果可以构建一个在运行时配置的通用验证函数，会是一个好选择。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// object validation rules</span></span><br><span class="line"><span class="keyword">const</span> schema = &#123;</span><br><span class="line">  first: &#123;</span><br><span class="line">    required:<span class="literal">true</span></span><br><span class="line">  &#125;,</span><br><span class="line">  last: &#123;</span><br><span class="line">    required:<span class="literal">true</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// universal validation function</span></span><br><span class="line"><span class="keyword">const</span> validate = <span class="function">(<span class="params">schema, values</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">for</span>(field <span class="keyword">in</span> schema) &#123;</span><br><span class="line">    <span class="keyword">if</span>(schema[field].required) &#123;</span><br><span class="line">      <span class="keyword">if</span>(!values[field]) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(validate(schema, &#123;<span class="attr">first</span>:<span class="string">'Bruce'</span>&#125;)); <span class="comment">// false</span></span><br><span class="line"><span class="built_in">console</span>.log(validate(schema, &#123;<span class="attr">first</span>:<span class="string">'Bruce'</span>,<span class="attr">last</span>:<span class="string">'Wayne'</span>&#125;)); <span class="comment">// true</span></span><br></pre></td></tr></table></figure>

<p>现在有了这个验证函数，我们就可以在所有窗体中重用，而无需为每个窗体编写自定义验证函数。</p>

  </div>
  <footer class="article-footer">
    
  <div class="cc">
    <a href="http://creativecommons.org/licenses/by-sa/4.0/deed.z" target="_blank" title="署名-相同方式共享">
      <img src="/images/cc/cc.png">
      
          <img src="/images/cc/by.png">
        
          <img src="/images/cc/sa.png">
      
      <span>
        本作品采用知识共享 署名-相同方式共享 4.0 国际许可协议进行许可。
      </span>
    </a>
  </div>


    

  </footer>
</article>







          <div class="main-footer">
  
    © 2022 一个爱听歌的搬砖工 - Powered by <a href="http://hexo.io" target="_blank">Hexo</a> - Theme <a href="https://github.com/denjones/hexo-theme-chan" target="_blank">Chan</a>
  
</div>
<script src="https://cdn.jsdelivr.net/npm/meting@1.0.1/dist/Meting.min.js"></script>
      
        </div>
      
    </div>
  </div>
  <script src="//apps.bdimg.com/libs/jquery/2.1.4/jquery.min.js"></script>

  <link rel="stylesheet" href="/PhotoSwipe/photoswipe.css">
  <link rel="stylesheet" href="/PhotoSwipe/default-skin/default-skin.css">

  <!-- Root element of PhotoSwipe. Must have class pswp. -->
  <div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe.
             It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

      <!-- Container that holds slides.
                PhotoSwipe keeps only 3 of them in the DOM to save memory.
                Don't modify these 3 pswp__item elements, data is added later on. -->
      <div class="pswp__container">
        <div class="pswp__item"></div>
        <div class="pswp__item"></div>
        <div class="pswp__item"></div>
      </div>

      <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
      <div class="pswp__ui pswp__ui--hidden">

        <div class="pswp__top-bar">

          <!--  Controls are self-explanatory. Order can be changed. -->

          <div class="pswp__counter"></div>

          <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

          <button class="pswp__button pswp__button--share" title="Share"></button>

          <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

          <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

          <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
          <!-- element will get class pswp__preloader--active when preloader is running -->
          <div class="pswp__preloader">
            <div class="pswp__preloader__icn">
              <div class="pswp__preloader__cut">
                <div class="pswp__preloader__donut"></div>
              </div>
            </div>
          </div>
        </div>

        <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
          <div class="pswp__share-tooltip"></div>
        </div>

        <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)"></button>

        <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button>

        <div class="pswp__caption">
          <div class="pswp__caption__center"></div>
        </div>
      </div>
    </div>
  </div>

  <script src="/PhotoSwipe/photoswipe.js"></script>
  <script src="/PhotoSwipe/photoswipe-ui-default.js"></script>


<script src="/perfect-scrollbar/js/min/perfect-scrollbar.min.js"></script>
<script src="/scripts/main.js"></script>

</body>
</html>
